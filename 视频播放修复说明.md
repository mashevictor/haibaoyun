# 🎬 网站视频播放修复指南

## 问题说明

网站视频无法播放的原因：
1. ❌ 视频格式不兼容浏览器
2. ❌ 视频编码不支持网页播放
3. ❌ 视频文件路径不正确
4. ❌ 视频没有针对网页优化

## ✅ 解决方案

### 🚀 一键修复（最简单）

**双击运行：** `一键修复视频播放.bat`

这个工具会自动：
1. ✅ 检查 FFmpeg 是否已安装
2. ✅ 压缩视频为网页兼容格式（H.264）
3. ✅ 保持视频原始尺寸不变
4. ✅ 创建正确的文件夹结构
5. ✅ 将视频复制到正确位置
6. ✅ 启动网站服务器
7. ✅ 自动打开浏览器

---

### 📋 手动修复步骤

如果需要手动操作，请按以下步骤：

#### 步骤 1：压缩视频

双击运行：`压缩视频使其可播放.bat`

这会将视频压缩为网页兼容格式：
- 格式：MP4 (H.264 + AAC)
- 尺寸：保持原始分辨率不变
- 输出：`video/视频1_web.mp4`

#### 步骤 2：修复路径

双击运行：`修复视频路径.bat`

这会：
- 创建 `video/compressed/` 文件夹
- 将压缩后的视频复制到该文件夹
- 重命名为网站需要的文件名

#### 步骤 3：启动网站

双击运行：`一键启动网站.bat`

---

## 📁 文件结构说明

压缩和修复后的文件结构：

```
video/
├── 视频1.mp4              # 原始视频
├── 视频1_web.mp4          # 压缩后的视频
├── 视频2.mp4
├── 视频2_web.mp4
├── 视频3.mp4
├── 视频3_web.mp4
├── 视频4.mp4
├── 视频4_web.mp4
└── compressed/            # 网站使用的文件夹
    ├── 视频1.mp4          # = 视频1_web.mp4 的副本
    ├── 视频2.mp4
    ├── 视频3.mp4
    └── 视频4.mp4
```

---

## 🎯 压缩参数说明

视频压缩使用以下参数：

| 参数 | 值 | 说明 |
|------|-----|------|
| **编码格式** | H.264 | 所有浏览器兼容 |
| **分辨率** | **保持不变** | 不改变视频尺寸 |
| **质量** | CRF 28 | 高压缩率，质量可接受 |
| **音频** | AAC 96kbps | 标准网页音频 |
| **优化** | faststart | 边下载边播放 |

**预期效果：**
- 文件大小减少 60-80%
- 加载速度提升 2-5 倍
- 所有浏览器都能播放

---

## 🌐 网站视频引用

网站 HTML 文件引用视频的方式：

```html
<video controls autoplay muted loop>
    <source src="../video/compressed/视频1.mp4" type="video/mp4">
    您的浏览器不支持视频播放。
</source>
```

**关键点：**
- 路径：`../video/compressed/视频1.mp4`
- 格式：必须是 MP4 (H.264)
- 编码：使用 H.264 + AAC
- 优化：包含 faststart 标记

---

## 📍 包含视频的页面

以下页面使用视频：

1. **场景页面**
   - 路径：`pages/scenarios.html`
   - 视频：视频1.mp4, 视频4.mp4

2. **云游戏页面**
   - 路径：`pages/cloudgaming.html`
   - 视频：相关游戏视频

3. **工作流程页面**
   - 路径：`pages/workflow.html`
   - 视频：流程演示视频

---

## ✅ 验证视频播放

### 方法 1：访问网站页面

1. 启动网站：`一键启动网站.bat`
2. 访问包含视频的页面
3. 检查视频是否自动播放

### 方法 2：使用测试页面

1. 启动网站
2. 访问：`http://localhost:8000/测试视频加载.html`
3. 查看压缩前后的对比

---

## 🔧 工具文件说明

| 文件 | 功能 |
|------|------|
| `一键修复视频播放.bat` | 👍 **推荐**：全自动修复和启动 |
| `压缩视频使其可播放.bat` | 只压缩视频 |
| `修复视频路径.bat` | 只修复文件夹结构 |
| `压缩网站视频.py` | Python 压缩脚本 |
| `一键启动网站.bat` | 启动网站服务器 |

---

## ❓ 常见问题

### Q: 为什么视频还是不能播放？

**A:** 请检查：
1. FFmpeg 是否已安装？运行 `诊断问题.bat` 检查
2. 视频是否已压缩？检查 `video/` 文件夹是否有 `_web.mp4` 文件
3. compressed 文件夹是否存在？
4. 浏览器是否支持 H.264？（现代浏览器都支持）

### Q: 视频压缩后尺寸改变了吗？

**A:** 不会！压缩脚本会保持原始分辨率不变，只优化编码和比特率。

### Q: 压缩需要多长时间？

**A:** 取决于视频大小，通常：
- 1 分钟视频：1-3 分钟
- 5 分钟视频：5-10 分钟

### Q: 可以重复压缩吗？

**A:** 可以，但不推荐。多次压缩会降低质量。

### Q: 压缩后质量如何？

**A:** 使用 CRF 28，肉眼几乎看不出差异，但文件大小减少 60-80%。

---

## 🎯 推荐流程

**首次使用：**
```
1. 双击：一键修复视频播放.bat
2. 等待处理完成（几分钟）
3. 浏览器自动打开网站
4. 测试视频播放
```

**日常使用：**
```
1. 双击：一键启动网站.bat
2. 访问网站
```

---

## 📝 技术细节

### FFmpeg 命令

```bash
ffmpeg -i 输入视频.mp4 \
  -c:v libx264 \
  -crf 28 \
  -preset slow \
  -maxrate 2M \
  -bufsize 4M \
  -c:a aac \
  -b:a 96k \
  -movflags +faststart \
  -pix_fmt yuv420p \
  输出视频_web.mp4
```

### 关键参数

- `-c:v libx264`：H.264 视频编码
- `-crf 28`：恒定质量因子
- `-maxrate 2M`：最大比特率 2Mbps
- `-movflags +faststart`：优化网络播放
- `-pix_fmt yuv420p`：兼容性像素格式

---

## 🆘 需要帮助？

如果遇到问题：

1. **运行诊断工具**
   ```
   双击：诊断问题.bat
   ```

2. **查看错误信息**
   - 压缩窗口的错误提示
   - 浏览器控制台的错误
   - 服务器窗口的日志

3. **检查文件**
   - `video/` 文件夹是否有原始视频？
   - `video/` 文件夹是否有 `_web.mp4`？
   - `video/compressed/` 文件夹是否存在？

---

**更新日期：** 2026-01-22  
**版本：** 1.0
