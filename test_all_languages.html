<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤šè¯­è¨€å…¨é‡æµ‹è¯•</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: Arial, sans-serif;
            background: #0a0e27;
            color: #fff;
            padding: 20px;
        }
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .test-section {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(0, 212, 255, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        .test-section h2 {
            color: #00d4ff;
            margin-bottom: 15px;
            border-bottom: 2px solid rgba(0, 212, 255, 0.3);
            padding-bottom: 10px;
        }
        .test-item {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid #00d4ff;
        }
        .test-item.pass {
            border-left-color: #00ff00;
        }
        .test-item.fail {
            border-left-color: #ff0000;
        }
        .test-item.warning {
            border-left-color: #ffaa00;
        }
        .test-button {
            background: rgba(0, 212, 255, 0.2);
            border: 1px solid rgba(0, 212, 255, 0.5);
            color: #00d4ff;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .test-button:hover {
            background: rgba(0, 212, 255, 0.3);
        }
        .log {
            background: rgba(0, 0, 0, 0.5);
            padding: 15px;
            border-radius: 8px;
            max-height: 400px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 0.85rem;
            line-height: 1.6;
        }
        .log-item {
            margin: 5px 0;
            padding: 5px;
        }
        .log-item.pass { color: #00ff00; }
        .log-item.fail { color: #ff0000; }
        .log-item.warning { color: #ffaa00; }
        .log-item.info { color: #00d4ff; }
        .progress-bar {
            width: 100%;
            height: 30px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            overflow: hidden;
            margin: 20px 0;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00d4ff, #0066ff);
            transition: width 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-weight: bold;
        }
        .stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        .stat-card {
            background: rgba(0, 212, 255, 0.1);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid rgba(0, 212, 255, 0.3);
        }
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #00d4ff;
        }
        .stat-label {
            font-size: 0.9rem;
            color: #a0aec0;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸŒ å¤šè¯­è¨€å…¨é‡æµ‹è¯•ç³»ç»Ÿ</h1>
        
        <div class="stats">
            <div class="stat-card">
                <div class="stat-value" id="totalTests">0</div>
                <div class="stat-label">æ€»æµ‹è¯•æ•°</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="passedTests">0</div>
                <div class="stat-label">é€šè¿‡</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="failedTests">0</div>
                <div class="stat-label">å¤±è´¥</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="progressPercent">0%</div>
                <div class="stat-label">è¿›åº¦</div>
            </div>
        </div>
        
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill" style="width: 0%">0%</div>
        </div>
        
        <div class="test-section">
            <h2>æµ‹è¯•æ§åˆ¶</h2>
            <button class="test-button" onclick="startFullTest()">ğŸš€ å¼€å§‹å…¨é‡æµ‹è¯•</button>
            <button class="test-button" onclick="testLanguageButton()">ğŸ”˜ æµ‹è¯•è¯­è¨€æŒ‰é’®</button>
            <button class="test-button" onclick="testAllLanguages()">ğŸŒ æµ‹è¯•æ‰€æœ‰è¯­è¨€</button>
            <button class="test-button" onclick="testAllPages()">ğŸ“„ æµ‹è¯•æ‰€æœ‰é¡µé¢</button>
            <button class="test-button" onclick="clearLog()">ğŸ—‘ï¸ æ¸…ç©ºæ—¥å¿—</button>
        </div>
        
        <div class="test-section">
            <h2>æµ‹è¯•ç»“æœ</h2>
            <div id="testResults"></div>
        </div>
        
        <div class="test-section">
            <h2>æµ‹è¯•æ—¥å¿—</h2>
            <div id="log" class="log"></div>
        </div>
    </div>
    
    <script>
        let testStats = {
            total: 0,
            passed: 0,
            failed: 0,
            warnings: 0
        };
        
        const languages = ['zh-CN', 'zh-TW', 'en', 'ja', 'ko'];
        const pages = [
            'index.html',
            'pages/scenarios.html',
            'pages/token.html',
            'pages/hardware-factory.html',
            'pages/research-strength.html',
            'pages/developer.html',
            'pages/about.html'
        ];
        
        function log(message, type = 'info') {
            const logDiv = document.getElementById('log');
            const time = new Date().toLocaleTimeString();
            const logItem = document.createElement('div');
            logItem.className = `log-item ${type}`;
            logItem.textContent = `[${time}] ${message}`;
            logDiv.appendChild(logItem);
            logDiv.scrollTop = logDiv.scrollHeight;
            console.log(`[${type.toUpperCase()}] ${message}`);
        }
        
        function updateStats() {
            document.getElementById('totalTests').textContent = testStats.total;
            document.getElementById('passedTests').textContent = testStats.passed;
            document.getElementById('failedTests').textContent = testStats.failed;
            const percent = testStats.total > 0 ? Math.round((testStats.passed / testStats.total) * 100) : 0;
            document.getElementById('progressPercent').textContent = percent + '%';
            document.getElementById('progressFill').style.width = percent + '%';
            document.getElementById('progressFill').textContent = percent + '%';
        }
        
        function addTestResult(name, status, message) {
            testStats.total++;
            if (status === 'pass') testStats.passed++;
            else if (status === 'fail') testStats.failed++;
            else if (status === 'warning') testStats.warnings++;
            
            const resultsDiv = document.getElementById('testResults');
            const testItem = document.createElement('div');
            testItem.className = `test-item ${status}`;
            testItem.innerHTML = `
                <strong>${name}</strong><br>
                <span style="color: ${status === 'pass' ? '#00ff00' : status === 'fail' ? '#ff0000' : '#ffaa00'}">
                    ${status === 'pass' ? 'âœ“ é€šè¿‡' : status === 'fail' ? 'âœ— å¤±è´¥' : 'âš  è­¦å‘Š'}
                </span>
                ${message ? '<br>' + message : ''}
            `;
            resultsDiv.appendChild(testItem);
            updateStats();
        }
        
        function clearLog() {
            document.getElementById('log').innerHTML = '';
            document.getElementById('testResults').innerHTML = '';
            testStats = { total: 0, passed: 0, failed: 0, warnings: 0 };
            updateStats();
        }
        
        async function testLanguageButton() {
            log('å¼€å§‹æµ‹è¯•è¯­è¨€æŒ‰é’®...', 'info');
            
            // æµ‹è¯•1: æ£€æŸ¥æŒ‰é’®æ˜¯å¦å­˜åœ¨
            const btn = document.querySelector('.lang-switch');
            if (!btn) {
                addTestResult('è¯­è¨€æŒ‰é’®å­˜åœ¨æ€§æ£€æŸ¥', 'fail', 'æœªæ‰¾åˆ°è¯­è¨€æŒ‰é’®');
                log('é”™è¯¯ï¼šæœªæ‰¾åˆ°è¯­è¨€æŒ‰é’®', 'fail');
                return;
            }
            addTestResult('è¯­è¨€æŒ‰é’®å­˜åœ¨æ€§æ£€æŸ¥', 'pass');
            log('âœ“ è¯­è¨€æŒ‰é’®å­˜åœ¨', 'pass');
            
            // æµ‹è¯•2: æ£€æŸ¥æŒ‰é’®æ˜¯å¦å¯ç‚¹å‡»
            let clickable = false;
            btn.onclick = () => { clickable = true; };
            btn.click();
            await sleep(100);
            
            if (clickable || window.languageManager) {
                addTestResult('è¯­è¨€æŒ‰é’®å¯ç‚¹å‡»æ€§', 'pass');
                log('âœ“ è¯­è¨€æŒ‰é’®å¯ç‚¹å‡»', 'pass');
            } else {
                addTestResult('è¯­è¨€æŒ‰é’®å¯ç‚¹å‡»æ€§', 'warning', 'æŒ‰é’®å¯èƒ½ä½¿ç”¨äº‹ä»¶å§”æ‰˜');
                log('âš  æŒ‰é’®å¯èƒ½ä½¿ç”¨äº‹ä»¶å§”æ‰˜', 'warning');
            }
            
            // æµ‹è¯•3: æµ‹è¯•æ‰€æœ‰è¯­è¨€çš„åˆ‡æ¢
            for (const lang of languages) {
                log(`æµ‹è¯•åˆ‡æ¢åˆ° ${lang}...`, 'info');
                if (window.languageManager) {
                    window.languageManager.updateLanguage(lang);
                    await sleep(200);
                    
                    const currentLang = window.languageManager.getCurrentLanguage();
                    if (currentLang === lang) {
                        addTestResult(`è¯­è¨€åˆ‡æ¢: ${lang}`, 'pass');
                        log(`âœ“ æˆåŠŸåˆ‡æ¢åˆ° ${lang}`, 'pass');
                    } else {
                        addTestResult(`è¯­è¨€åˆ‡æ¢: ${lang}`, 'fail', `æœŸæœ›: ${lang}, å®é™…: ${currentLang}`);
                        log(`âœ— åˆ‡æ¢åˆ° ${lang} å¤±è´¥`, 'fail');
                    }
                    
                    // æµ‹è¯•åˆ‡æ¢åæŒ‰é’®æ˜¯å¦ä»ç„¶å¯ç”¨
                    await sleep(100);
                    const btnAfter = document.querySelector('.lang-switch');
                    if (btnAfter) {
                        addTestResult(`åˆ‡æ¢åæŒ‰é’®å¯ç”¨æ€§: ${lang}`, 'pass');
                        log(`âœ“ åˆ‡æ¢åæŒ‰é’®ä»ç„¶å¯ç”¨: ${lang}`, 'pass');
                    } else {
                        addTestResult(`åˆ‡æ¢åæŒ‰é’®å¯ç”¨æ€§: ${lang}`, 'fail');
                        log(`âœ— åˆ‡æ¢åæŒ‰é’®ä¸¢å¤±: ${lang}`, 'fail');
                    }
                }
            }
        }
        
        async function testAllLanguages() {
            log('å¼€å§‹æµ‹è¯•æ‰€æœ‰è¯­è¨€...', 'info');
            
            if (!window.languageManager) {
                addTestResult('è¯­è¨€ç®¡ç†å™¨åˆå§‹åŒ–', 'fail', 'è¯­è¨€ç®¡ç†å™¨æœªåˆå§‹åŒ–');
                log('é”™è¯¯ï¼šè¯­è¨€ç®¡ç†å™¨æœªåˆå§‹åŒ–', 'fail');
                return;
            }
            addTestResult('è¯­è¨€ç®¡ç†å™¨åˆå§‹åŒ–', 'pass');
            
            // æµ‹è¯•æ¯ä¸ªè¯­è¨€çš„ç¿»è¯‘å®Œæ•´æ€§
            for (const lang of languages) {
                log(`æµ‹è¯•è¯­è¨€: ${lang}`, 'info');
                window.languageManager.updateLanguage(lang);
                await sleep(200);
                
                // æ£€æŸ¥å…³é”®ç¿»è¯‘é”®
                const keys = [
                    'nav.product',
                    'nav.scenario',
                    'nav.developer',
                    'nav.token',
                    'nav.about',
                    'nav.hardwareFactory',
                    'nav.researchStrength',
                    'home.title',
                    'architecture.title'
                ];
                
                let missingKeys = [];
                for (const key of keys) {
                    const translation = window.languageManager.getTranslation(key);
                    if (translation === key || !translation) {
                        missingKeys.push(key);
                    }
                }
                
                if (missingKeys.length === 0) {
                    addTestResult(`ç¿»è¯‘å®Œæ•´æ€§: ${lang}`, 'pass');
                    log(`âœ“ ${lang} ç¿»è¯‘å®Œæ•´`, 'pass');
                } else {
                    addTestResult(`ç¿»è¯‘å®Œæ•´æ€§: ${lang}`, 'fail', `ç¼ºå¤±: ${missingKeys.join(', ')}`);
                    log(`âœ— ${lang} ç¿»è¯‘ç¼ºå¤±: ${missingKeys.join(', ')}`, 'fail');
                }
                
                // æ£€æŸ¥é¡µé¢å…ƒç´ æ˜¯å¦æ­£ç¡®ç¿»è¯‘
                const elements = document.querySelectorAll('[data-i18n]');
                let untranslated = 0;
                elements.forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    const translation = window.languageManager.getTranslation(key);
                    if (translation === key || !translation || el.textContent === '') {
                        untranslated++;
                    }
                });
                
                if (untranslated === 0) {
                    addTestResult(`é¡µé¢å…ƒç´ ç¿»è¯‘: ${lang}`, 'pass');
                    log(`âœ“ ${lang} é¡µé¢å…ƒç´ å…¨éƒ¨ç¿»è¯‘`, 'pass');
                } else {
                    addTestResult(`é¡µé¢å…ƒç´ ç¿»è¯‘: ${lang}`, 'warning', `${untranslated} ä¸ªå…ƒç´ æœªç¿»è¯‘`);
                    log(`âš  ${lang} æœ‰ ${untranslated} ä¸ªå…ƒç´ æœªç¿»è¯‘`, 'warning');
                }
            }
        }
        
        async function testAllPages() {
            log('å¼€å§‹æµ‹è¯•æ‰€æœ‰é¡µé¢...', 'info');
            
            for (const page of pages) {
                log(`æµ‹è¯•é¡µé¢: ${page}`, 'info');
                try {
                    const response = await fetch(page);
                    if (response.ok) {
                        addTestResult(`é¡µé¢å¯è®¿é—®: ${page}`, 'pass');
                        log(`âœ“ ${page} å¯è®¿é—®`, 'pass');
                    } else {
                        addTestResult(`é¡µé¢å¯è®¿é—®: ${page}`, 'fail', `HTTP ${response.status}`);
                        log(`âœ— ${page} ä¸å¯è®¿é—®: HTTP ${response.status}`, 'fail');
                    }
                } catch (error) {
                    addTestResult(`é¡µé¢å¯è®¿é—®: ${page}`, 'fail', error.message);
                    log(`âœ— ${page} è®¿é—®é”™è¯¯: ${error.message}`, 'fail');
                }
            }
        }
        
        async function startFullTest() {
            clearLog();
            log('ğŸš€ å¼€å§‹å…¨é‡æµ‹è¯•...', 'info');
            
            // æµ‹è¯•1: è¯­è¨€æŒ‰é’®
            await testLanguageButton();
            await sleep(500);
            
            // æµ‹è¯•2: æ‰€æœ‰è¯­è¨€
            await testAllLanguages();
            await sleep(500);
            
            // æµ‹è¯•3: æ‰€æœ‰é¡µé¢
            await testAllPages();
            
            log('âœ… å…¨é‡æµ‹è¯•å®Œæˆï¼', 'pass');
            
            // ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š
            const report = `
æµ‹è¯•å®Œæˆï¼
æ€»æµ‹è¯•æ•°: ${testStats.total}
é€šè¿‡: ${testStats.passed}
å¤±è´¥: ${testStats.failed}
è­¦å‘Š: ${testStats.warnings}
é€šè¿‡ç‡: ${Math.round((testStats.passed / testStats.total) * 100)}%
            `;
            log(report, 'info');
        }
        
        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨å¼€å§‹æµ‹è¯•
        window.addEventListener('load', () => {
            log('æµ‹è¯•ç³»ç»Ÿå·²åŠ è½½', 'info');
            log('ç‚¹å‡»"å¼€å§‹å…¨é‡æµ‹è¯•"æŒ‰é’®å¼€å§‹æµ‹è¯•', 'info');
        });
    </script>
</body>
</html>
